# Template 3A: Busca todos os tickers de um SETOR

PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX b3: <https://dcm.ffclrp.usp.br/lssb/stock-market-ontology#>

SELECT DISTINCT ?ticker 
WHERE {
  # Encontra a inst√¢ncia do setor pelo seu label
  ?setorUri rdfs:label #SETOR# . 
  
  # Encontra a empresa que atua nesse setor
  ?empresa b3:atuaEm ?setorUri .
  
  # A partir da empresa, segue o caminho para o ticker
  ?empresa b3:temValorMobiliarioNegociado ?valorMobiliario .
  ?valorMobiliario b3:representadoPor [ b3:ticker ?ticker ] .
  
  FILTER REGEX(STR(?ticker), "^[A-Z]{4}[0-9]{1,2}$", "i")
}
ORDER BY ?ticker